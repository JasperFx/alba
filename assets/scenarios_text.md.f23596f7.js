import{_ as n,c as s,o as a,a as t}from"./app.bb080ae4.js";const g='{"title":"Working with Plain Text Requests","description":"","frontmatter":{},"headers":[{"level":2,"title":"Reading the Response Text","slug":"reading-the-response-text"},{"level":2,"title":"Assertions against the Response Text","slug":"assertions-against-the-response-text"},{"level":2,"title":"Sending Text","slug":"sending-text"}],"relativePath":"scenarios/text.md","lastUpdated":1644418893215}',e={},p=t(`<h1 id="working-with-plain-text-requests" tabindex="-1">Working with Plain Text Requests <a class="header-anchor" href="#working-with-plain-text-requests" aria-hidden="true">#</a></h1><p>If you find yourself needing to test HTTP endpoints that either send text or return text, Alba has you covered with some built in helpers.</p><h2 id="reading-the-response-text" tabindex="-1">Reading the Response Text <a class="header-anchor" href="#reading-the-response-text" aria-hidden="true">#</a></h2><p>To read the response body as text, use this syntax:</p><p><a id="snippet-sample_read_text"></a></p><div class="language-cs"><pre><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">read_text</span><span class="token punctuation">(</span><span class="token class-name">IAlbaHost</span> host<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> <span class="token keyword">await</span> host<span class="token punctuation">.</span><span class="token function">Scenario</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        _<span class="token punctuation">.</span>Get<span class="token punctuation">.</span><span class="token function">Url</span><span class="token punctuation">(</span><span class="token string">&quot;/output&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// This deserializes the response body to the</span>
    <span class="token comment">// designated Output type</span>
    <span class="token class-name"><span class="token keyword">var</span></span> outputString <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">ReadAsText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// do assertions against the Output string</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/Alba.Testing/Samples/JsonAndXml.cs#L72-L86" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_read_text" title="Start of snippet">anchor</a></sup></p><h2 id="assertions-against-the-response-text" tabindex="-1">Assertions against the Response Text <a class="header-anchor" href="#assertions-against-the-response-text" aria-hidden="true">#</a></h2><p>You have these built in operations for asserting on the response body text:</p><p><a id="snippet-sample_assert_on_text"></a></p><div class="language-cs"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name">Task</span> <span class="token function">assert_on_content</span><span class="token punctuation">(</span><span class="token class-name">IAlbaHost</span> host<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> host<span class="token punctuation">.</span><span class="token function">Scenario</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        _<span class="token punctuation">.</span><span class="token function">ContentShouldBe</span><span class="token punctuation">(</span><span class="token string">&quot;exactly this&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        _<span class="token punctuation">.</span><span class="token function">ContentShouldContain</span><span class="token punctuation">(</span><span class="token string">&quot;some snippet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        _<span class="token punctuation">.</span><span class="token function">ContentShouldNotContain</span><span class="token punctuation">(</span><span class="token string">&quot;some warning&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/Alba.Testing/Samples/JsonAndXml.cs#L88-L100" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_assert_on_text" title="Start of snippet">anchor</a></sup></p><h2 id="sending-text" tabindex="-1">Sending Text <a class="header-anchor" href="#sending-text" aria-hidden="true">#</a></h2><p>Lastly, you can send text to an HTTP endpoint with this syntax:</p><p><a id="snippet-sample_send_text"></a></p><div class="language-cs"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name">Task</span> <span class="token function">send_text</span><span class="token punctuation">(</span><span class="token class-name">IAlbaHost</span> host<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> host<span class="token punctuation">.</span><span class="token function">Scenario</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        _<span class="token punctuation">.</span>Post<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">&quot;some text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/textdata&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/Alba.Testing/Samples/JsonAndXml.cs#L103-L111" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_send_text" title="Start of snippet">anchor</a></sup></p><p>Do note that this also sets the <code>content-length</code> header to the string length and sets the <code>content-type</code> header of the request to &quot;text/plain.&quot;</p>`,18),o=[p];function c(i,u,l,r,k,d){return a(),s("div",null,o)}var _=n(e,[["render",c]]);export{g as __pageData,_ as default};
