import{_ as n,c as s,o as a,a as t}from"./app.bb080ae4.js";const h='{"title":"Sending and Checking Xml","description":"","frontmatter":{},"headers":[{"level":2,"title":"Sending Xml in the Request","slug":"sending-xml-in-the-request"},{"level":2,"title":"Reading Xml from the Response","slug":"reading-xml-from-the-response"}],"relativePath":"scenarios/xml.md","lastUpdated":1644418893220}',e={},p=t(`<h1 id="sending-and-checking-xml" tabindex="-1">Sending and Checking Xml <a class="header-anchor" href="#sending-and-checking-xml" aria-hidden="true">#</a></h1><p>I wasn&#39;t sure that Xml over HTTP was all that common of a use case anymore, but the very first project we used Alba on turned out to be an Xml API, so here we are.</p><p>In all cases, Alba just uses the old, built in <code>XmlSerializer</code> from the .Net BCL.</p><h2 id="sending-xml-in-the-request" tabindex="-1">Sending Xml in the Request <a class="header-anchor" href="#sending-xml-in-the-request" aria-hidden="true">#</a></h2><p>There&#39;s a similar helper for Xml serialization that allows you to send an object as xml to the web request:</p><p><a id="snippet-sample_sending_xml"></a></p><div class="language-cs"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name">Task</span> <span class="token function">send_xml</span><span class="token punctuation">(</span><span class="token class-name">IAlbaHost</span> host<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> host<span class="token punctuation">.</span><span class="token function">Scenario</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// This serializes the Input object to xml,</span>
        <span class="token comment">// writes it to the HttpRequest.Body, and sets</span>
        <span class="token comment">// the accepts &amp; content-type header values to</span>
        <span class="token comment">// application/xml</span>
        _<span class="token punctuation">.</span>Post
            <span class="token punctuation">.</span><span class="token function">Xml</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Input</span> <span class="token punctuation">{</span>Name <span class="token operator">=</span> <span class="token string">&quot;Max&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ToUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/person&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// OR, if url lookup is enabled, this is an equivalent:</span>
        _<span class="token punctuation">.</span>Post<span class="token punctuation">.</span><span class="token function">Xml</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Input</span> <span class="token punctuation">{</span>Name <span class="token operator">=</span> <span class="token string">&quot;Max&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/Alba.Testing/Samples/JsonAndXml.cs#L27-L44" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_sending_xml" title="Start of snippet">anchor</a></sup></p><h2 id="reading-xml-from-the-response" tabindex="-1">Reading Xml from the Response <a class="header-anchor" href="#reading-xml-from-the-response" aria-hidden="true">#</a></h2><p>There&#39;s a helper off of the <code>HttpResponseBody</code> for reading Xml from the response:</p><p><a id="snippet-sample_read_xml"></a></p><div class="language-cs"><pre><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">read_xml</span><span class="token punctuation">(</span><span class="token class-name">IAlbaHost</span> host<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> <span class="token keyword">await</span> host<span class="token punctuation">.</span><span class="token function">Scenario</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        _<span class="token punctuation">.</span>Get<span class="token punctuation">.</span><span class="token function">Url</span><span class="token punctuation">(</span><span class="token string">&quot;/output&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// This deserializes the response body to the</span>
    <span class="token comment">// designated Output type</span>
    <span class="token class-name"><span class="token keyword">var</span></span> output <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">ReadAsXml</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Output<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// do assertions against the Output model</span>

    <span class="token comment">// OR, if you just want the XmlDocument itself:</span>
    <span class="token class-name">XmlDocument</span> document <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">ReadAsXml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/Alba.Testing/Samples/JsonAndXml.cs#L115-L132" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_read_xml" title="Start of snippet">anchor</a></sup></p>`,13),o=[p];function c(l,u,i,r,k,m){return a(),s("div",null,o)}var f=n(e,[["render",c]]);export{h as __pageData,f as default};
